var gadash=gadash||{};gadash.userInfo={};gadash.isLoaded=!1;gadash.SCOPES=["https://www.googleapis.com/auth/analytics.readonly","https://www.googleapis.com/auth/userinfo.email"];gadash.commandQueue=[];
gadash.init=function(a){gadash.apiKey=a.apiKey;gadash.clientId=a.clientId;gadash.util.loadJs_(["https://www.google.com/jsapi?autoload="+encodeURIComponent('{"modules":[{"name":"visualization","version":"1","callback":"__globalCallback","packages":["corechart","table"]}]}'),"https://apis.google.com/js/client.js?onload=__globalCallback"],window.gadashInit,!0)};window.gadashInit=function(){gapi.client.setApiKey(gadash.apiKey);window.setTimeout(gadash.checkAuth,1)};
gadash.checkAuth=function(){gapi.auth.authorize({client_id:gadash.clientId,scope:gadash.SCOPES,immediate:!0},gadash.handleAuthResult)};gadash.handleAuthResult=function(a){a?(gapi.client.setApiVersions({analytics:"v3"}),gapi.client.load("analytics","v3",gadash.loadUserName)):gadash.handleUnAuthorized()};gadash.loadUserName=function(){gapi.client.request({path:"/oauth2/v2/userinfo"}).execute(function(a){gadash.userInfo=a;gadash.handleAuthorized()})};
gadash.handleAuthorized=function(){var a="You are authorized";gadash.userInfo.email&&(a+=" as "+gadash.util.htmlEscape(gadash.userInfo.email));document.getElementById("gadash-auth").innerHTML=a+' <button id="authorize-button">Logout</button>';document.getElementById("authorize-button").onclick=function(){document.location="https://accounts.google.com/logout"};gadash.isLoaded=!0;gadash.executeCommandQueue()};
gadash.handleUnAuthorized=function(){document.getElementById("gadash-auth").innerHTML='<button id="authorize-button">Authorize Analytics</button>';document.getElementById("authorize-button").onclick=gadash.handleAuthClick};gadash.handleAuthClick=function(){gapi.auth.authorize({client_id:gadash.clientId,scope:gadash.SCOPES,immediate:!1},gadash.handleAuthResult);return!1};gadash.executeCommandQueue=function(){for(var a=0,b;b=gadash.commandQueue[a];++a)b()};gadash.CoreQuery=function(a){this.config={};this.set(a);return this};gadash.CoreQuery.prototype.set=function(a){gadash.util.extend(a,this.config);return this};gadash.CoreQuery.prototype.render=function(){if(gadash.isLoaded)this.renderFunction();else{var a=gadash.util.bindMethod(this,this.renderFunction);gadash.commandQueue.push(a)}return this};
gadash.CoreQuery.prototype.renderFunction=function(){this.setDefaultDates(this.config);gapi.client.analytics.data.ga.get(this.config.query).execute(gadash.util.bindMethod(this,this.callback))};
gadash.CoreQuery.prototype.setDefaultDates=function(a){if(a["last-n-days"])a.query["end-date"]=gadash.util.lastNdays(0),a.query["start-date"]=gadash.util.lastNdays(this.config["last-n-days"]);else if(!a.query["start-date"]||!a.query["end-date"])a.query["end-date"]=gadash.util.lastNdays(0),a.query["start-date"]=gadash.util.lastNdays(28)};
gadash.CoreQuery.prototype.callback=function(a){a.error?this.defaultOnError(a.error.code+" "+a.error.message):this.config.onSuccess?gadash.util.bindMethod(this,this.config.onSuccess)(a):this.defaultOnSuccess(a)};
gadash.CoreQuery.prototype.defaultOnError=function(a){if(this.config.onError)this.config.onError(a);else{var b=document.getElementById("errors");b||(b=document.createElement("div"),b.style.color="red",b.setAttribute("id","errors"),b.innerHTML="ERRORS:<br />",document.body.appendChild(b));b.innerHTML+=" error: "+a+"<br />"}};gadash.CoreQuery.prototype.defaultOnSuccess=function(){};gadash.util=gadash.util||{};gadash.util.convertDateFormat=function(a){0==(new String(a.getValue(0,0))).search(/^(20)\d{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])$/)&&gadash.util.convertToMMMd(a)};gadash.util.convertToMMMd=function(a){for(var b=a.getNumberOfRows(),c=0;c<b;c++)a.setValue(c,0,gadash.util.stringDateToString(a.getValue(c,0)));return a};
gadash.util.stringDateToString=function(a){if(0==a.search(/^(20)\d{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])$/)){var b={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"}[a.substring(4,6)];a=a.substring(6,8);10>a&&(a=a.substring(1,2));a=b+" "+a}return a};gadash.util.bindMethod=function(a,b){return function(){return b.apply(a,arguments)}};
gadash.util.lastNdays=function(a){var b=new Date;b.setDate((new Date).getDate()-a);a=b.getFullYear();var c=b.getMonth()+1;10>c&&(c="0"+c);b=b.getDate();10>b&&(b="0"+b);return[a,c,b].join("-")};gadash.util.stringToDate=function(a){var b=a.substring(0,4),c=a.substring(4,6);a=a.substring(6,8);10>c&&(c=c.substring(1,2));c-=1;10>a&&(a=a.substring(1,2));return new Date(b,c,a)};
gadash.util.formatGAString=function(a){var b=a.substring(3),b=b.charAt(0).toUpperCase()+b.slice(1);for(a=1;a<b.length;a++)if(b.charAt(a)==b.charAt(a).toUpperCase()){var c=b.substring(0,a),b=b.substring(a,b.length),b=[c,b].join(" ");a++}return b};gadash.util.extend=function(a,b){for(var c in a)"object"==gadash.util.getType(a[c])?(b[c]=b[c]||{},gadash.util.extend(a[c],b[c])):b[c]=a[c]};
gadash.util.getType=function(a){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Array]":"array","[object Date]":"date","[object RegExp]":"regex","[object Object]":"object"}[Object.prototype.toString.call(a)]};
gadash.util.htmlEscape=function(a){if(!/[&<>\"]/.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(/&/g,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(/</g,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(/>/g,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(/"/g,"&quot;"));return a};gadash.util.loadJs_Resource=function(a,b){var c=document.createElement("script");c.async=!0;c.src=a;b&&(c.onload=b);var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d)};window.__globalCallback={};
gadash.util.loadJs_=function(a,b,c){b=gadash.getIncrementalCallback(a.length,b);c&&(window.__globalCallback=b);for(var d=0,g;g=a[d];++d)c?gadash.util.loadJs_Resource(g):gadash.util.loadJs_Resource(g,b)};gadash.getIncrementalCallback=function(a,b){var c=0;return function(){++c;c>=a&&b()}};gadash.gviz=gadash.gviz||{};gadash.Chart=function(a){this.config={};this.set(a);return this};gadash.Chart.prototype=new gadash.CoreQuery;gadash.Chart.prototype.defaultOnSuccess=function(a){a=gadash.gviz.getDataTable(a,this.config.type);var b=gadash.gviz.getChart(this.config.divContainer,this.config.type);gadash.gviz.draw(b,a,this.config.chartOptions)};
gadash.gviz.getDataTable=function(a,b){var c=b||!1,d=new google.visualization.DataTable,g=a.columnHeaders.length,l;a.rows&&a.rows.length?l=a.rows.length:this.defaultOnError("No rows returned for that query.");for(var e=0;e<g;e++){var f=a.columnHeaders[e].dataType,k=a.columnHeaders[e].name,f="ga:date"==k&&!("ColumnChart"==c||"BarChart"==c)?"date":"STRING"==f?"string":"number";d.addColumn(f,gadash.util.formatGAString(k))}for(e=0;e<l;e++){for(var j=[],h=0;h<g;h++)k=a.columnHeaders[h].name,f=a.columnHeaders[h].dataType,
"ga:date"==k&&!("ColumnChart"==c||"BarChart"==c)?j.push(gadash.util.stringToDate(a.rows[e][h])):"INTEGER"==f?j.push(parseInt(a.rows[e][h])):"CURRENCY"==f?j.push(parseFloat(a.rows[e][h])):"PERCENT"==f||"TIME"==f||"FLOAT"==f?j.push(Math.round(100*a.rows[e][h])/100):j.push(a.rows[e][h]);d.addRow(j)}for(e=0;e<g;e++)f=a.columnHeaders[e].dataType,"CURRENCY"==f&&(new google.visualization.NumberFormat({fractionDigits:2})).format(d,e);return d};
gadash.gviz.getChart=function(a,b){var c=document.getElementById(a);return google.visualization[b]?new google.visualization[b](c):new google.visualization.Table(c)};gadash.gviz.draw=function(a,b,c){gadash.util.convertDateFormat(b);gadash.gviz.createDateFormater(b);a.draw(b,c)};gadash.gviz.createDateFormater=function(a){(new google.visualization.DateFormat({pattern:"MMM d"})).format(a,0)};
gadash.GaLineChart=function(a,b,c,d){this.config={};this.set({divContainer:a,query:{ids:b,metrics:c,dimensions:"ga:date"}}).set(gadash.gviz.defaultChartOptions).set(gadash.gviz.lineChart).set(d);return this};gadash.GaLineChart.prototype=new gadash.Chart;gadash.GaAreaChart=function(a,b,c,d){this.config={};this.set({divContainer:a,query:{ids:b,metrics:c,dimensions:"ga:date"}}).set(gadash.gviz.defaultChartOptions).set(gadash.gviz.areaChart).set(d);return this};gadash.GaAreaChart.prototype=new gadash.Chart;
gadash.GaPieChart=function(a,b,c,d,g){this.config={};this.set({divContainer:a,query:{ids:b,metrics:c,dimensions:d}}).set(gadash.gviz.defaultChartOptions).set(gadash.gviz.pieChart).set(g);return this};gadash.GaPieChart.prototype=new gadash.Chart;gadash.GaBarChart=function(a,b,c,d){this.config={};this.set({divContainer:a,query:{ids:b,metrics:c,dimensions:"ga:date"}}).set(gadash.gviz.defaultChartOptions).set(gadash.gviz.barChart).set(d);return this};gadash.GaBarChart.prototype=new gadash.Chart;
gadash.GaColumnChart=function(a,b,c,d){this.config={};this.set({divContainer:a,query:{ids:b,metrics:c,dimensions:"ga:date"}}).set(gadash.gviz.defaultChartOptions).set(gadash.gviz.columnChart).set(d);return this};gadash.GaColumnChart.prototype=new gadash.Chart;gadash.gviz.defaultChartOptions={chartOptions:{height:300,width:450,fontSize:12,curveType:"function",titleTextStyle:{fontName:"Arial",fontSize:15,bold:!1}}};
gadash.gviz.lineChart={type:"LineChart",chartOptions:{pointSize:6,lineWidth:4,areaOpacity:0.1,legend:{position:"top",alignment:"start"},colors:["#058dc7"],hAxis:{format:"MMM d",gridlines:{color:"transparent"},baselineColor:"transparent"},vAxis:{gridlines:{color:"#efefef",logScale:"true",count:3},textPosition:"in"}}};
gadash.gviz.areaChart={type:"AreaChart",chartOptions:{pointSize:6,lineWidth:4,areaOpacity:0.1,legend:{position:"top",alignment:"start"},colors:["#058dc7"],hAxis:{format:"MMM d",gridlines:{count:3,color:"transparent"},baselineColor:"transparent"},vAxis:{gridlines:{color:"#efefef",logScale:"true",count:3},textPosition:"in"}}};gadash.gviz.pieChart={type:"PieChart",chartOptions:{legend:{position:"right",textStyle:{bold:"true",fontSize:13},alignment:"center",pieSliceText:"none"}}};
gadash.gviz.barChart={type:"BarChart",chartOptions:{legend:{position:"top",alignment:"start"},colors:["#058dc7"],hAxis:{gridlines:{count:3,color:"#efefef"},minValue:0,baselineColor:"transparent"},vAxis:{gridlines:{color:"transparent"},count:3,textPosition:"in"}}};
gadash.gviz.columnChart={type:"ColumnChart",chartOptions:{legend:{position:"top",alignment:"start"},colors:["#058dc7"],hAxis:{gridlines:{count:3,color:"transparent"},baselineColor:"transparent"},vAxis:{gridlines:{color:"#efefef",count:3},minValue:0,textPosition:"in"}}};
